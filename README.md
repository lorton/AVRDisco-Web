# AVRDisco-Web

A modern, mobile-optimized web interface for controlling Denon/Marantz AV receivers over telnet. Originally generated by Claude Code, now significantly enhanced with modern Python practices, security improvements, and better UX.

Perfect for running on a Raspberry Pi to provide smartphone control of your AV receiver.

## Features

- ðŸ“± **Mobile-First Design** - Optimized touch targets (56px), responsive layout
- ðŸ”’ **Secure** - Command validation, CORS configuration, input sanitization
- ðŸš€ **Modern Python** - Type hints, Python 3.13+ compatible, no deprecated dependencies
- ðŸŽ¯ **Easy Configuration** - Environment variables, .env file support, sensible defaults
- ðŸ”„ **Reliable** - Automatic retry with exponential backoff, better error handling
- ðŸ“Š **Visual Feedback** - Loading states, command history, real-time status
- ðŸ§ª **Well-Tested** - Comprehensive test suite with pytest
- âš¡ **Async Version Available** - Real-time state tracking, WebSocket support, better performance

## Quick Start

### Standard Version (Synchronous)
```bash
# Install dependencies
pip install -r requirements.txt

# Optional: Configure your receiver
cp .env.example .env
# Edit .env with your receiver's IP and port

# Run the server
python app.py

# Open in browser
# http://localhost:5000
```

### Async Version (Recommended - with Real-time State Tracking)
```bash
# Install async dependencies
pip install -r requirements/async.txt

# Run the async server
python async_app.py

# Open in browser
# http://localhost:5000
```

See [ASYNC_VERSION.md](ASYNC_VERSION.md) for full async documentation.

## Installation on Raspberry Pi

```bash
# Clone repository
git clone <your-repo-url>
cd AVRDisco-Web

# Install Python dependencies
pip install -r requirements.txt

# Configure for your receiver
cp .env.example .env
nano .env  # Edit with your receiver's IP address

# Run on all network interfaces
python app.py --host 0.0.0.0 --port 5000

# Access from your phone at http://<raspberry-pi-ip>:5000
```

## Configuration

Configure via environment variables, .env file, or command-line arguments:

- `AVR_HOST` - AV Receiver IP address (default: 192.168.1.100)
- `AVR_PORT` - Telnet port (default: 60128 for Denon/Marantz)
- `HOST` - Web server host (default: localhost)
- `PORT` - Web server port (default: 5000)
- `CORS_ORIGINS` - Allowed CORS origins (default: http://localhost:5000)
- `LOG_LEVEL` - Logging level: DEBUG/INFO/WARNING/ERROR (default: INFO)
- `DEBUG` - Enable debug mode (prints commands without sending)

See `.env.example` for all options.

## Documentation

- **[CLAUDE.md](CLAUDE.md)** - Comprehensive project documentation
- **[IMPROVEMENTS.md](IMPROVEMENTS.md)** - Detailed changelog of all improvements
- **[IMPLEMENTATION_SUMMARY.md](IMPLEMENTATION_SUMMARY.md)** - Quick overview of what was implemented

## Recent Improvements

This project has been significantly enhanced from the original Claude Code generation:

âœ… **Python 3.13+ Compatible** - Replaced deprecated telnetlib
âœ… **Type Hints** - Full type annotations throughout
âœ… **Security** - Command validation, CORS configuration
âœ… **Better UX** - Loading states, command history, improved mobile design
âœ… **Reliability** - Retry logic with exponential backoff
âœ… **Modern Config** - .env file support, modular requirements

See [IMPROVEMENTS.md](IMPROVEMENTS.md) for complete list.

## Development

```bash
# Install development dependencies
pip install -r requirements/dev.txt

# Run tests
pytest -v

# Type checking
mypy app.py avr_controller.py

# Code formatting
black .

# Linting
flake8 .
```

## Supported Receivers

Tested with Denon/Marantz receivers using telnet control protocol. Common models:
- Denon AVR series (AVR-X3400H, AVR-X4500H, etc.)
- Marantz SR/AV series

Check your receiver manual for telnet control port (usually 23 or 60128).

## License

[Your license here]

## Credits

Originally generated by [Claude Code](https://claude.ai/code), enhanced with modern Python practices and comprehensive improvements.
